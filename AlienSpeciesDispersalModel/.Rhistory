x<-seq(0,1,length.out=1001)
head(x)
tail(x)
colour<-rev(heat_hcl(length(x), c = c(80, 30), l = c(30, 90), power = c(1/5, 2)))
plot(x,col=colour)
plot(x,col=colour)
roads_shp@data$norm <- round(roads_shp@data$Pinv,3)
head(roads_shp@data$norm)
table(roads_shp@data$norm)
?as.data.frame
?data.frame
norm<-seq(0,1,length.out=1001)
colour<-rev(heat_hcl(length(norm), c = c(80, 30), l = c(30, 90), power = c(1/5, 2)))
x<-data.frame(norm,colour)
head(x)
x<-data.frame(as.numeric(norm),colour)
head(x)
x<-data.frame(norm,colour)
head(x)
x$norm<-as.numeric(x$norm)
x$norm<-as.numeric(as.character(x$norm))
x<-data.frame(norm,colour)
x$norm<-as.numeric(as.character(x$norm))
head(x)
roads_shp@data<-merge(roads_shp@data,x,by=norm,all=F)
roads_shp@data<-merge(roads_shp@data,x,by="norm",all=F)
head(roads_shp@data)
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- round(roads_shp@data$Pinv,3)
head(roads_shp@data)
roads_shp@data<-merge(roads_shp@data,x,by="norm",all=F)
head(roads_shp@data)
#  png(filename = file.path(save_dir,(paste0("SpreadModel_map",sprintf("%04d", as.numeric(names(list_results)[i])),".png"))),width=7,height=8,units = "in",res=c(3*72))
x11(width=7,height=8)
op <- par(mar=rep(0,4))
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=colour)
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=roads_shp@data$colour)
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=as.characther(roads_shp@data$colour))
plot(roads_shp,add=T,col=as.character(roads_shp@data$colour))
norm<-seq(0,1,length.out=1001)
colour<-rev(heat_hcl(length(norm), c = c(80, 30), l = c(30, 90), power = c(1/5, 2)))
x<-data.frame(norm,colour)
plot(x$norm,col=x$colour)
norm<-seq(0,1,length.out=1001)
colour<-rev(heat_hcl(length(norm), c = c(80, 30), l = c(30, 90), power = c(1/5, 2)))
plot(norm,col=colour)
x<-cbind(norm,colour)
str(x)
plot(x[,1],col=x[,2])
x<-as.data.frame(cbind(norm,colour))
plot(x$norm,col=x$colour)
head(x)
x$norm<-as.numeric(as.character(x$norm))
x$colour<-as.character(x$colour)
plot(x$norm,col=x$colour)
norm<-seq(0,1,length.out=1001)
colour<-rev(heat_hcl(length(norm), c = c(80, 30), l = c(30, 90), power = c(1/5, 2)))
x<-as.data.frame(cbind(norm,colour))
x$norm<-as.numeric(as.character(x$norm))
x$colour<-as.character(x$colour)
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- round(roads_shp@data$Pinv,3)
roads_shp@data<-merge(roads_shp@data,x,by="norm")
plot(roads_shp@data$norm,col=roads_shp@data$colour)
x11(width=7,height=8)
op <- par(mar=rep(0,4))
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=as.character(roads_shp@data$colour))
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=roads_shp@data$colour)
plot(roads_shp@data$Pinv,col=roads_shp@data$colour)
norm<-seq(0,1,length.out=1001)
colour<-rev(heat_hcl(length(norm), c = c(80, 30), l = c(30, 90), power = c(1/5, 2)))
color<-as.data.frame(cbind(norm,colour))
color$norm<-as.character(color$norm)
color$colour<-as.character(color$colour)
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- as.character(round(roads_shp@data$Pinv,3))
roads_shp@data<-merge(roads_shp@data,color,by="norm")
x11(width=7,height=8)
op <- par(mar=rep(0,4))
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=roads_shp@data$colour)
color
str(color)
roads_shp@data[roads_shp@data$norm=="0.95"]
roads_shp@data[roads_shp@data$norm=="0.95"]
roads_shp@data[roads_shp@data$norm=="0.95"]
roads_shp@data[roads_shp@data$norm=="0.1"]
norm<-seq(0,1,length.out=1001)
colour <- rev(colorRampPalette(c("red","orange","yellow"))(1001))
pal<-as.data.frame(cbind(norm,colour))
pal$norm<-as.numeric(as.character(pal$norm))
pal$colour<-as.numeric(pal$colour)
plot(pal$norm,col=pal$colour)
norm<-seq(0,1,length.out=1001)
colour <- rev(colorRampPalette(c("red","orange","yellow"))(1001))
pal<-as.data.frame(cbind(norm,colour))
pal$norm<-as.numeric(as.character(pal$norm))
pal$colour<-as.character(pal$colour)
plot(pal$norm,col=pal$colour)
pal$colour[pal$norm==0]<-"lightgray"
plot(pal$norm,col=pal$colour)
head(pal)
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- round(roads_shp@data$Pinv,3)
head(roads_shp@data)
norm<-seq(0,1,length.out=1001)
colour <- rev(colorRampPalette(c("red","orange","yellow"))(1001))
pal<-as.data.frame(cbind(norm,colour))
pal$colour<-as.character(pal$colour)
pal$colour[pal$norm==0]<-"lightgray"
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- as.factor(round(roads_shp@data$Pinv,3))
head(roads_shp@data)
head(pal)
head(merge(roads_shp@data,pal,by="norm"))
tail(merge(roads_shp@data,pal,by="norm"))
?merge
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- as.factor(round(roads_shp@data$Pinv,3))
tail(merge(roads_shp@data,pal,by="norm",sort=FALSE))
x11(width=7,height=8)
op <- par(mar=rep(0,4))
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=roads_shp@data$color)
norm<-seq(0,1,length.out=1001)
color <- rev(colorRampPalette(c("red","orange","yellow"))(1001))
pal<-as.data.frame(cbind(norm,colour))
pal$color<-as.character(pal$colour)
pal$color[pal$norm==0]<-"lightgray"
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- as.factor(round(roads_shp@data$Pinv,3))
roads_shp@data<-merge(roads_shp@data,pal,by="norm",sort=FALSE)
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=roads_shp@data$color)
norm<-seq(0,1,length.out=10001)
color <- rev(colorRampPalette(c("red","orange","yellow"))(10001))
pal<-as.data.frame(cbind(norm,colour))
pal$color<-as.character(pal$colour)
pal$color[pal$norm==0]<-"lightgray"
roads_shp@data <-modelResults[[3]]
roads_shp@data$norm <- as.factor(round(roads_shp@data$Pinv,4))
roads_shp@data<-merge(roads_shp@data,pal,by="norm",sort=FALSE)
plot(border_shp,axes=F,
panel.first=rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4]),lwd=0.1)
plot(roads_shp,add=T,col=roads_shp@data$color)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
install.packages(c("SearchTrees", "rgeos"))
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
setwd("C:/Users/mbagnara/Desktop/BiK-F postDoc/Model/16-Aug-2018 17-16-52")
system("C:/ImageMagick-7.0.8-Q16/convert.exe -delay 80 *.png ModelSpread.gif")
setwd(mainDir)
dir_data<-"C:/Users/mbagnara/Dropbox/AlienSpeciesSpread/Data/TestDataRoad/20180314_Verkehrsbelastungen2015_DTV"
netw_data<-"20180704_BelastungLkwPkw" #network layer
data_plot<- "road_shp.Rdata"
initCoords <- data.frame(Long=9.9938531,Lat=53.5396466)  # Hamburg Hafen
if (file.exists(file.path(dir_data,data_plot))) load(file.path(dir_data,data_plot))
roads_shp@data$ID<-paste(roads_shp@data$Von_Knoten,roads_shp@data$Nach_Knote,sep="_")
roads_shp@data[, c(4,6,7)]<-sapply(roads_shp@data[, c(4,6,7)], as.numeric)
road_netw <- as.data.table(roads_shp@data)
road_netw[,Traffic:=DTVLkw+ DTVPkw]
library(rgdal) # only used for plotting
library(sf)
library(data.table)
road_netw <- as.data.table(roads_shp@data)
road_netw[,Traffic:=DTVLkw+ DTVPkw]
road_netw <- road_netw[,.(Von_Knoten,Nach_Knote,Laenge,Typ, Traffic,ID)]
names(road_netw) <- c("FromNode","ToNode","Length","Type","Traffic","ID")
setkey(road_netw,FromNode)
##### start simulation ############################################
### node file #####################################
node_state <- as.data.table(unique(c(road_netw[,unique(FromNode)],road_netw[,unique(ToNode)])))
node_state[,state:=0]
node_state[,newarrivals:=0]
names(node_state) <- c("FromNode","state","newarrivals")
node_state[,newarrivals:=as.numeric(newarrivals)]
setkey(node_state,FromNode)
### initialising simulation #######################
init_segm <- getNeighbourSegm(shapeObj=roads_shp,initCoords=initCoords)
getNeighbourSegm<- function(shapeObj,initCoords){
## extract coordinates from shapefile
res <- lapply(slot(shapeObj, "lines"), function(x) lapply(slot(x, "Lines"),function(y) slot(y, "coords")))
names(res)<-shapeObj@data$ID
segsID<-sapply(lapply(res,"[[",1),nrow)
coords<-as.data.frame(do.call("rbind",lapply(res,"[[",1)),stringsAsFactors=F)
coords$ID<-rep(names(segsID),segsID)
library(SearchTrees)
## create a 'search tree' from coordinates
tree <- createTree(coords[,1:2]) # required to calculate the nearest neighbour for each ship coordinate and check if it within a range to the next port
## get ID of nearest segment, the ID is the same as in road_shp (at least, it should be)
inds <- knnLookup(tree,newdat=initCoords,k=1) # lookup nearest neighbour, 'k' determines the number of nearest neighbors
inds<-coords[inds,3]
return(inds)
}
source('~/GitHub/AlienSpeciesSpread/AlienSpeciesDispersalModel/R/getNeighborSegmCoord.R', echo=TRUE)
### initialising simulation #######################
init_segm <- getNeighbourSegm(shapeObj=roads_shp,initCoords=initCoords)
init_nodes <- road_netw[ID%in%init_segm,1:2]
init_nodes
node_state[FromNode%in%init_nodes,state:=1]
road_netw[ID%in%init_segm,Pinv]
road_netw[,p_attach:=f_attach(Length,parameters[nparset,"att1"],parameters[nparset,"att2"],parameters[nparset,"att3"],p=1)]
road_netw[,p_attach:= 1-(1-p_attach)^(Traffic*parameters[nparset,"pickup_prob"])]
road_netw[,Pinv=0]
road_netw[,Pinv:=0]
road_netw[ID%in%init_segm,Pinv]
road_netw[ID%in%init_segm,c(Pinv,FromNode()]
road_netw[ID%in%init_segm,c(Pinv,FromNode)]
init_nodes <- road_netw[ID%in%init_segm,c(FromNode,ToNode)]
node_state[FromNode%in%init_nodes,state:=1]
road_netw[ID%in%init_segm,Pinv:=1]
road_netw[ID%in%init_segm,]
library(AlienSpeciesDispersalModel)
library(AlienSpeciesDispersalModel)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/AlienSpeciesDispersalModel/R/getNeighborSegmCoord.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
source('~/GitHub/AlienSpeciesSpread/AlienSpeciesDispersalModel/R/plotResults.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
init_coords <- data.frame(Long=c(9.9938531,13.2862487),Lat=c(53.5396466,52.5588327)) # Hamburg Hafen & Berlin airport
init_coords
knnLookup
?knnLookup
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
source('~/GitHub/AlienSpeciesSpread/InitializationScript.R', echo=TRUE)
setwd("C:/Users/mbagnara/Desktop/BiK-F postDoc/Model/17-Aug-2018 17-22-14")
system("C:/ImageMagick-7.0.8-Q16/convert.exe -delay 80 *.png ModelSpread.gif")
setwd(mainDir)
library(SearchTrees)
?knnLookup
str(tree)
?createTree
x = rnorm(100)
y = rnorm(100)
dat = cbind(x,y)
tree = createTree(dat)
str(tree)
library(geosphere)
?geosphere
xy <- rbind(c(0,0),c(90,90),c(10,10),c(-120,-45))
distm(xy)
xy2 <- rbind(c(0,0),c(10,-10))
distm(xy, xy2)
xy <- rbind(c(0,0),c(90,90),c(10,10),c(-120,-45))
distm(xy)
xy2 <- rbind(c(0,0),c(10,-10))
distm(xy, xy2,fun=distVincentyEllipsoid)
dir_data<-"C:/Users/mbagnara/Dropbox/AlienSpeciesSpread/Data/TestDataRoad/20180314_Verkehrsbelastungen2015_DTV"
netw_data<-"20180704_BelastungLkwPkw" #network layer
Rdata_file<- "road_shp.Rdata"
init_coords <- data.frame(Long=c(9.9938531,13.2862487),Lat=c(53.5396466,52.5588327)) # Hamburg Hafen & Berlin airport
if (file.exists(file.path(dir_data,Rdata_file))) load(file.path(dir_data,Rdata_file))
res <- lapply(slot(shapeObj, "lines"), function(x) lapply(slot(x, "Lines"),function(y) slot(y, "coords")))
names(res)<-shapeObj@data$ID
segsID<-sapply(lapply(res,"[[",1),nrow)
coords<-as.data.frame(do.call("rbind",lapply(res,"[[",1)),stringsAsFactors=F)
coords$ID<-rep(names(segsID),segsID)
shapeObj<-roads_shp
res <- lapply(slot(shapeObj, "lines"), function(x) lapply(slot(x, "Lines"),function(y) slot(y, "coords")))
names(res)<-shapeObj@data$ID
segsID<-sapply(lapply(res,"[[",1),nrow)
coords<-as.data.frame(do.call("rbind",lapply(res,"[[",1)),stringsAsFactors=F)
coords$ID<-rep(names(segsID),segsID)
head(coordd)
head(coords)
coords<-as.data.frame(do.call("rbind",lapply(res,"[[",1)),stringsAsFactors=F)
colnames(coords)<- c("lon","lat")
coords$ID<-rep(names(segsID),segsID)
head(coords)
dist<-distm(coords[,1:2], init_coords,fun=distVincentyEllipsoid)
i<-1
neighbor <- knnLookup(tree,newdat=init_coords[i,],k=100) # lookup nearest neighbour, 'k' determines the number of nearest neighbors
head(neighbor)
## get ID of nearest segment, the ID is the same as in road_shp (at least, it should be)
ids<-c()
ids<-c(ids,coords[neighbor,])
ids
unlist(ids)
as.data.frame(ids)
dist<-distm(ids2[,1:2], init_coords[,i],fun=distVincentyEllipsoid)
ids2<-as.data.frame(ids)
dist<-distm(ids2[,1:2], init_coords[,i],fun=distVincentyEllipsoid)
dist
ids2$dist<-distm(ids2[,1:2], init_coords[i,],fun=distVincentyEllipsoid)
hist(ids2$dist)
ids2[,1:2]
init_coords
neighbor <- knnLookup(tree,newdat=init_coords[i,],k=1) # lookup nearest neighbour, 'k' determines the number of nearest neighbors
ids<-c(ids,coords[neighbor,])
ids2<-as.data.frame(ids)
ids2$dist<-distm(ids2[,1:2], init_coords[i,],fun=distVincentyEllipsoid)
ids2
## get ID of nearest segment, the ID is the same as in road_shp (at least, it should be)
ids<-c()
ids<-c(ids,coords[neighbor,])
ids2<-as.data.frame(ids)
ids2$dist<-distm(ids2[,1:2], init_coords[i,],fun=distVincentyEllipsoid)
ids
ids2
## create a 'search tree' from coordinates
tree <- createTree(coords[,1:2]) # required to calculate the nearest neighbour for each set of coordinates
## get ID of nearest segment, the ID is the same as in road_shp (at least, it should be)
ids<-c()
neighbor <- knnLookup(tree,newdat=init_coords[i,],k=1) # lookup nearest neighbour, 'k' determines the number of nearest neighbors
ids<-c(ids,coords[neighbor,])
ids
ids2<-as.data.frame(ids)
ids2$dist<-distm(ids2[,1:2], init_coords[i,],fun=distVincentyEllipsoid)
ids2
neighbor <- knnLookup(tree,newdat=init_coords[i,],k=100) # lookup nearest neighbour, 'k' determines the number of nearest neighbors
ids<-c(ids,coords[neighbor,])
ids2<-as.data.frame(ids)
ids2$dist<-distm(ids2[,1:2], init_coords[i,],fun=distVincentyEllipsoid)
ids2
neighbor <- knnLookup(tree,newdat=init_coords[i,],k=100) # lookup nearest neighbour, 'k' determines the number of nearest neighbors
## get ID of nearest segment, the ID is the same as in road_shp (at least, it should be)
ids<-c()
ids<-c(ids,coords[neighbor,])
ids
ids2<-as.data.frame(ids)
ids2$dist<-distm(ids2[,1:2], init_coords[i,],fun=distVincentyEllipsoid)
ids2
max_dist=1000
unique(ids2$ID[ids2$dist<max_dist])
as.character(unique(ids2$ID[ids2$dist<max_dist]))
getwd()
readRDS(file = "data/LandCocer_Roads_50m.rds", refhook = NULL)
LCtype<-readRDS(file = "data/LandCocer_Roads_50m.rds", refhook = NULL)
str(LCtype)
summary(LCtype$LC_ID)
rm(LCtype)
LandCover<-readRDS(file = "data/LandCocer_Roads_50m.rds", refhook = NULL)
LandCover$Suitable<-NA
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-unique(LandCover$LinkID)
?subset
i<-ids[1]
i
LC<-subset(LandCover,LinkID=i)
LC
LC<-subset(LandCover,LinkID==i)
head(LC)
LC
LC$Suitable<-sum(LC$prop[LC$LC_ID>10 & LC$LC_ID<34])
LC
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-unique(LandCover$LinkID)
ids<-as.data.frame(ids,NA)
ids<-as.data.frame(ids,Suitable=NA)
head(ids)
ids<-as.data.frame(cbind(ids,Suitable=NA))
ids<-unique(LandCover$LinkID)
ids<-as.data.frame(cbind(ids,Suitable=NA))
ids
head(ids)
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-unique(LandCover$LinkID)
ids<-as.data.frame(cbind(ids,Suitable=NA))
for (i in ids) {
LC<-subset(LandCover,LinkID==i)
ids$Suitable[ids$linkID==i]<-sum(LC$prop[LC$LC_ID>10 & LC$LC_ID<34])
}
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-unique(LandCover$LinkID)
ids<-as.data.frame(cbind(ids,Suitable=NA))
head(ids)
i
headids
head(ids)
colnames(ids)
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-unique(LandCover$LinkID)
ids<-as.data.frame(cbind(LinkID=ids,Suitable=NA))
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-as.data.frame(cbind(LinkID=unique(LandCover$LinkID),Suitable=NA))
ids
for (i in ids$LinkID) {
LC<-subset(LandCover,LinkID==i)
ids$Suitable[ids$linkID==i]<-sum(LC$prop[LC$LC_ID>10 & LC$LC_ID<34])
}
warnings()
str(LandCover)
LClist<list<-list()
LClist<-list()
for (i in ids$LinkID) {
LC<-subset(LandCover,LinkID==i)
LClist[["i"]]<-subset(LC,select = c(LC_ID, prop))
}
?split.data.frame
ma <- cbind(x = 1:10, y = (-4:5)^2)
split(ma, col(ma))
head(ma)
g <- airquality$Month
g
l <- split(airquality, g)
l
ids<-unique(LandCover$LinkID)
l <- setnames(split(LandCover,unique(LandCover$LinkID)),unique(LandCover$LinkID))
l <- set.names(split(LandCover,unique(LandCover$LinkID)),unique(LandCover$LinkID))
l <- setNames(split(LandCover,unique(LandCover$LinkID)),unique(LandCover$LinkID))
str(l)
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-as.data.frame(cbind(LinkID=unique(LandCover$LinkID),Suitable=NA),stringsAsFactors = FALSE)
LClist<-list()
nrows(ids)
nrow(ids)
# for every link ID, sum proportion of LC_ID betweeen 10 and 34
ids<-as.data.frame(cbind(LinkID=unique(LandCover$LinkID),Suitable=NA),stringsAsFactors = FALSE)
LClist<-list()
for (i in ids$LinkID) LClist[["i"]]<-subset(LandCover,LinkID==i,select = c(LC_ID, prop))
length(LClist)
i
LClist
cat ("/n", i, "out of", length(ids$LinkID), "/n")
cat ("\n", i, "out of", length(ids$LinkID), "\n")
i<-1
ids$LinkID[i]
LClist[[ids$LinkID[i]]]<- subset(LandCover,LinkID==ids$LinkID[i],select = c(LC_ID, prop))
LClist
LClist<-list()
for (i in 1:length(ids$LinkID)){
LClist[[ids$LinkID[i]]]<- subset(LandCover,LinkID==ids$LinkID[i],select = c(LC_ID, prop))
cat ("\n", i, "out of", length(ids$LinkID), "\n")
}
save(LClist,"data/LClist.Rdata")
save(list = LClist,file = "data/LClist.Rdata")
save(LClist,file = "data/LClist.Rdata")
warnings()
data(LCtype)
data(LClist)
library(AlienSpeciesDispersalModel)
data(LClist)
data(LClist.Rdata)
data(LClist)
data(LClist)
rm(list=ls())
load("~/GitHub/AlienSpeciesSpread/AlienSpeciesDispersalModel/data/LClist.Rda")
ls()
str(LClist)
devtools::use_data(LClist, AlienSpeciesDispersalModel)
devtools::use_data(LClist)
library(AlienSpeciesDispersalModel)
rm(list=ls())
source('~/GitHub/AlienSpeciesSpread/Scripts/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/Scripts/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/Scripts/InitializationScript.R', echo=TRUE)
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/Scripts/InitializationScript.R', echo=TRUE)
if (file.exists(file.path(dir_data,Rdata_file))) load(file.path(dir_data,Rdata_file))
roads_shp@data$ID<-paste(roads_shp@data$Von_Knoten,roads_shp@data$Nach_Knote,sep="_")
roads_shp@data[, c(4,6,7)]<-sapply(roads_shp@data[, c(4,6,7)], as.numeric)
road_netw <- as.data.table(roads_shp@data)
road_netw[,Traffic:=DTVLkw+ DTVPkw]
road_netw <- road_netw[,.(Von_Knoten,Nach_Knote,Laenge,Typ, Traffic,ID)]
names(road_netw) <- c("FromNode","ToNode","Length","Type","Traffic","ID")
nparset<-1
road_netw[,p_natural:=f_natural(Length,parameters[nparset,"nat1"])]
if (incl_attachment) {
road_netw[,p_attach:=f_attach(Length,parameters[nparset,"att1"],parameters[nparset,"att2"],parameters[nparset,"att3"])]
road_netw[,p_attach:= 1-(1-p_attach)^(Traffic*parameters[nparset,"pickup_prob"])]
}
if (incl_airflow) {
road_netw[,p_airflow:=f_airflow(Length,parameters[nparset,"air1"],parameters[nparset,"air2"])]
road_netw[,p_airflow:= 1-(1-p_airflow)^(Traffic*parameters[nparset,"pickup_prob"])]
}
col_prob<-road_netw[,.SD,.SDcols=grep("p_",colnames(road_netw))]
road_netw[,Pi:=apply(col_prob,1,pUnion)] #prod by row
LCprop<-LCproportion(List=LClist,LandCoverID=LandCoverID) #requires LClist, provided as internal data in data/LClist.rda
LCprop<-LCproportion(List=LClist,LandCoverID=Suitable_LandCoverID) #requires LClist, provided as internal data in data/LClist.rda
setkey(road_netw,ID)
road_netw[LCprop, on="ID"]
library(AlienSpeciesDispersalModel)
source('~/GitHub/AlienSpeciesSpread/Scripts/InitializationScript.R', echo=TRUE)
summary(modelResults$p_natural)
summary(modelResults[[length(modelResults)]]$p_natural)
source('~/GitHub/AlienSpeciesSpread/Scripts/InitializationScript.R', echo=TRUE)
summary(modelResults[[length(modelResults)]]$p_natural)
